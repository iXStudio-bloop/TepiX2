<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TapiX 2</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      background: #1e1e1e;
      color: #fff;
      overflow: hidden;
    }

    /* –ó–∞—Å—Ç–∞–≤–∫–∞ */
    #splash {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #1e1e1e;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      z-index: 9999;
      opacity: 0;
      animation: fadeIn 1s forwards, fadeOut 1s forwards 2s;
    }
    .splash-logo { max-width: 200px; margin-bottom: 20px; }
    .splash-text { font-size: 22px; margin-bottom: auto; }
    .splash-footer {
      font-size: 12px;
      position: absolute;
      bottom: 15px;
      text-align: center;
      width: 100%;
      color: #aaa;
    }
    @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
    @keyframes fadeOut { from {opacity: 1;} to {opacity: 0;} }

    /* –ò–≥—Ä–∞ */
    #game {
      display: none;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .score-box {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 15px 30px;
      background: #333;
      border-radius: 12px;
      font-size: 22px;
      font-weight: bold;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    }

    .click-btn {
      padding: 40px 80px;
      font-size: 26px;
      font-weight: bold;
      border: none;
      border-radius: 16px;
      background: #ff4d4d;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 6px 15px rgba(255,77,77,0.6);
      transition: transform 0.1s;
    }
    .click-btn:active { transform: scale(0.95); background: #ff1a1a; }

    .settings-btn, .menu-btn {
      position: absolute;
      top: 20px;
      font-size: 24px;
      background: none;
      border: none;
      color: #fff;
      cursor: pointer;
    }
    .settings-btn { right: 20px; }
    .menu-btn { left: 20px; }

    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #2c2c2c;
      padding: 20px;
      border-radius: 12px;
      display: none;
      flex-direction: column;
      gap: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.5);
      text-align: center;
      max-width: 90%;
    }
    .modal label, .modal p { font-size: 18px; }
    .close-btn {
      margin-top: 15px;
      padding: 8px 16px;
      border: none;
      border-radius: 8px;
      background: #ff4d4d;
      color: #fff;
      cursor: pointer;
    }
    .version { margin-top: 15px; font-size: 14px; color: #aaa; }
    .menu-list button {
      padding: 10px;
      border: none;
      border-radius: 8px;
      background: #444;
      color: #fff;
      cursor: pointer;
      margin: 5px 0;
    }
    .menu-list button:hover { background: #666; }
    input#promoInput {
      padding: 8px;
      border-radius: 8px;
      border: none;
      width: 80%;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <!-- –ó–∞—Å—Ç–∞–≤–∫–∞ -->
  <div id="splash">
    <img src="ix.png" alt="iX logo" class="splash-logo">
    <p class="splash-text">iX –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç</p>
    <p class="splash-footer">2025. iX. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã –ê–≤—Ç–æ—Ä—Å–∫–∏–º –ü—Ä–∞–≤–æ–º.</p>
  </div>

  <!-- –ò–≥—Ä–∞ -->
  <div id="game">
    <div class="score-box">–û—á–∫–∏: <span id="score">0</span></div>
    <button class="click-btn" onclick="addPoint()">–ö–ª–∏–∫</button>

    <button class="settings-btn" onclick="toggleSettings()">‚öôÔ∏è</button>
    <button class="menu-btn" onclick="toggleMenu()">‚ãÆ</button>

    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div class="modal" id="settings">
      <label>
        <input type="checkbox" id="music-toggle" checked>
        üéµ –ú—É–∑—ã–∫–∞
      </label>
      <button class="close-btn" onclick="toggleSettings()">–ó–∞–∫—Ä—ã—Ç—å</button>
      <div class="version">V beta 0.1.0</div>
    </div>

    <!-- –ú–µ–Ω—é -->
    <div class="modal" id="menu">
      <div class="menu-list">
        <button onclick="openProfile()">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
        <button onclick="openPromo()">üéÅ –ü—Ä–æ–º–æ–∫–æ–¥—ã</button>
        <button onclick="window.open('https://t.me/The_iX_Studio','_blank')">üì¢ –ö–∞–Ω–∞–ª</button>
        <button onclick="confirmReset()">‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –æ—á–∫–∏</button>
      </div>
      <button class="close-btn" onclick="toggleMenu()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
    <div class="modal" id="profile">
      <h3>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h3>
      <p id="achievements">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç.</p>
      <button class="close-btn" onclick="closeModal('profile')">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <!-- –ü—Ä–æ–º–æ–∫–æ–¥—ã -->
    <div class="modal" id="promo">
      <h3>üéÅ –í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥</h3>
      <input type="text" id="promoInput" placeholder="–í–∞—à –∫–æ–¥">
      <button onclick="checkPromo()">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
      <p id="promoResult"></p>
      <button class="close-btn" onclick="closeModal('promo')">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π -->
    <div class="modal" id="messageModal">
      <p id="messageText"></p>
      <button class="close-btn" onclick="closeModal('messageModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <!-- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–±—Ä–æ—Å–∞ -->
    <div class="modal" id="confirmModal">
      <p>–í—ã —Ç–æ—á–Ω–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –æ—á–∫–∏?</p>
      <button onclick="resetScore()">–î–∞</button>
      <button onclick="closeModal('confirmModal')">–ù–µ—Ç</button>
    </div>
  </div>

  <!-- –ú—É–∑—ã–∫–∞ -->
  <audio id="bg-music" loop>
    <source src="clickmusic.mp3" type="audio/mpeg">
  </audio>

  <script>
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    let score = parseInt(localStorage.getItem("tapiX2Score") || "0");
    let unlocked = JSON.parse(localStorage.getItem("tapiX2Achievements") || "[]");
    let usedPromoCodes = JSON.parse(localStorage.getItem("tapiX2UsedPromoCodes") || "[]");
    document.getElementById("score").textContent = score;

    let music = document.getElementById("bg-music");
    let toggle = document.getElementById("music-toggle");
    let musicStarted = false;

    const achievements = [100, 500, 1000];

    const promoCodes = {
      "REDTAP": 150,
      "MEGACLICK": 500,
      "SECRET777": 777,
      "BOOST1000": 1000,
      "TAPSTAR": 300
    };

    // –ö–ª–∏–∫
    function addPoint() {
      score++;
      document.getElementById("score").textContent = score;
      localStorage.setItem("tapiX2Score", score);

      if (!musicStarted && toggle.checked) {
        music.play().catch(() => {}); 
        musicStarted = true;
      }

      achievements.forEach(a => {
        if (score >= a && !unlocked.includes(a)) {
          unlocked.push(a);
          localStorage.setItem("tapiX2Achievements", JSON.stringify(unlocked));
          showMessage("üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: " + a + " –∫–ª–∏–∫–æ–≤!");
        }
      });
    }

    // –ú–æ–¥–∞–ª–∫–∏
    function toggleSettings() {
      let s = document.getElementById("settings");
      s.style.display = s.style.display === "flex" ? "none" : "flex";
    }

    function toggleMenu() {
      let m = document.getElementById("menu");
      m.style.display = m.style.display === "flex" ? "none" : "flex";
    }

    toggle.addEventListener("change", () => {
      if (toggle.checked) {
        music.play().catch(() => {});
        musicStarted = true;
      } else {
        music.pause();
      }
    });

    function openProfile() {
      document.getElementById("menu").style.display = "none";
      let text = unlocked.length > 0 ? "–í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:<br>" + unlocked.join(", ") : "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç.";
      document.getElementById("achievements").innerHTML = text;
      document.getElementById("profile").style.display = "flex";
    }

    function openPromo() {
      document.getElementById("menu").style.display = "none";
      document.getElementById("promo").style.display = "flex";
    }

    function checkPromo() {
      let code = document.getElementById("promoInput").value.trim().toUpperCase();

      if (promoCodes[code]) {
        if (usedPromoCodes.includes(code)) {
          showMessage("‚ö†Ô∏è –≠—Ç–æ—Ç –∫–æ–¥ —É–∂–µ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω.");
        } else {
          score += promoCodes[code];
          document.getElementById("score").textContent = score;
          localStorage.setItem("tapiX2Score", score);

          usedPromoCodes.push(code);
          localStorage.setItem("tapiX2UsedPromoCodes", JSON.stringify(usedPromoCodes));

          showMessage("‚úÖ –ö–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! +" + promoCodes[code] + " –æ—á–∫–æ–≤.");
        }
      } else {
        showMessage("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥.");
      }

      document.getElementById("promoInput").value = "";
    }

    function showMessage(text) {
      document.getElementById("messageText").textContent = text;
      document.getElementById("messageModal").style.display = "flex";
    }

    function closeModal(id) {
      document.getElementById(id).style.display = "none";
    }

    function confirmReset() {
      document.getElementById("menu").style.display = "none";
      document.getElementById("confirmModal").style.display = "flex";
    }

    function resetScore() {
      score = 0;
      unlocked = [];
      usedPromoCodes = [];
      localStorage.setItem("tapiX2Score", score);
      localStorage.setItem("tapiX2Achievements", JSON.stringify(unlocked));
      localStorage.setItem("tapiX2UsedPromoCodes", JSON.stringify(usedPromoCodes));
      document.getElementById("score").textContent = score;
      closeModal('confirmModal');
      showMessage("‚ôªÔ∏è –í—Å–µ –æ—á–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã!");
    }

    // –ó–∞—Å—Ç–∞–≤–∫–∞ -> –∏–≥—Ä–∞
    window.addEventListener("load", () => {
      setTimeout(() => {
        document.getElementById("splash").style.display = "none";
        document.getElementById("game").style.display = "flex";
      }, 3000);
    });
  </script>
</body>
</html>
